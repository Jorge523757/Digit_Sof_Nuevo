{% extends 'main/gestion/base_gestion.html' %}

{% block header_icon %}<i class="fas fa-user-shield"></i>{% endblock %}

{% block stats_section %}
<div class="stats-cards">
    <div class="stat-card">
        <div class="stat-number">{{ stats.total_clientes }}</div>
        <div class="stat-label">Total Clientes</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{ stats.total_productos }}</div>
        <div class="stat-label">Total Productos</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{ stats.total_ordenes }}</div>
        <div class="stat-label">Órdenes Totales</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{ stats.ordenes_pendientes }}</div>
        <div class="stat-label">Órdenes Pendientes</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{ stats.total_ventas }}</div>
        <div class="stat-label">Ventas Totales</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{ stats.productos_bajo_stock }}</div>
        <div class="stat-label">Productos Bajo Stock</div>
    </div>
</div>
{% endblock %}

{% block table_section %}
<div class="row">
    <div class="col-md-6">
        <div class="table-container">
            <div class="table-header">
                <h2 class="table-title">
                    <i class="fas fa-clipboard-list"></i> Órdenes Recientes
                </h2>
            </div>
            {% if ordenes_recientes %}
            <table class="data-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Cliente</th>
                        <th>Técnico</th>
                        <th>Estado</th>
                        <th>Fecha</th>
                    </tr>
                </thead>
                <tbody>
                    {% for orden in ordenes_recientes %}
                    <tr>
                        <td>#{{ orden.id_ordenServicio }}</td>
                        <td>{{ orden.cliente.nombre }}</td>
                        <td>{{ orden.tecnico.nombre_completo }}</td>
                        <td>
                            <span class="badge {% if orden.estado == 'Pendiente' %}badge-warning{% else %}badge-success{% endif %}">
                                {{ orden.estado }}
                            </span>
                        </td>
                        <td>{{ orden.fecha_creacion|date:"d/m/Y" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <div class="empty-state">
                <i class="fas fa-clipboard-list"></i>
                <h4>No hay órdenes recientes</h4>
            </div>
            {% endif %}
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="table-container">
            <div class="table-header">
                <h2 class="table-title">
                    <i class="fas fa-chart-line"></i> Ventas Recientes
                </h2>
            </div>
            {% if ventas_recientes %}
            <table class="data-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Cliente</th>
                        <th>Producto</th>
                        <th>Cantidad</th>
                        <th>Valor</th>
                    </tr>
                </thead>
                <tbody>
                    {% for venta in ventas_recientes %}
                    <tr>
                        <td>#{{ venta.id_venta }}</td>
                        <td>{{ venta.cliente.nombre }}</td>
                        <td>{{ venta.producto.nombreProducto }}</td>
                        <td>{{ venta.cantidad_vendidas }}</td>
                        <td>${{ venta.valor_venta }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <div class="empty-state">
                <i class="fas fa-chart-line"></i>
                <h4>No hay ventas recientes</h4>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<style>
.row {
    display: flex;
    gap: 20px;
    margin-top: 30px;
}

.col-md-6 {
    flex: 1;
    min-width: 0;
}

@media (max-width: 768px) {
    .row {
        flex-direction: column;
    }
}
</style>
{% endblock %}