<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Factura {{ venta.numero_venta }} - DigitSoft</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background: #f5f5f5; padding: 20px; }
        .factura-container { max-width: 900px; margin: 2rem auto; background: white; padding: 3rem; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        .header-factura { border-bottom: 3px solid #667eea; padding-bottom: 1.5rem; margin-bottom: 2rem; }
        .logo-empresa { font-size: 2rem; font-weight: bold; color: #667eea; }
        .info-factura { background: #f8f9fa; padding: 1rem; border-radius: 8px; margin-bottom: 2rem; }
        .tabla-productos th { background: #667eea; color: white; padding: 12px; }
        .tabla-productos td { padding: 12px; border-bottom: 1px solid #e9ecef; }
        .totales { margin-top: 2rem; padding: 1.5rem; background: #f8f9fa; border-radius: 8px; }
        .total-final { font-size: 1.5rem; font-weight: bold; color: #28a745; padding-top: 1rem; border-top: 2px solid #dee2e6; }
        .success-icon { text-align: center; margin-bottom: 2rem; }
        .success-icon i { font-size: 4rem; color: #28a745; }
        .btn-print { background: #667eea; color: white; padding: 12px 32px; border: none; border-radius: 8px; margin: 0.5rem; }
        @media print { body { background: white; } .acciones-factura { display: none; } }
    </style>
</head>
<body>
    <div class="factura-container">
        <div class="success-icon">
            <i class="fas fa-check-circle"></i>
            <h2 class="mt-3">¡Compra Exitosa!</h2>
            <p class="text-muted">Tu pedido ha sido procesado correctamente</p>
        </div>

        <div class="header-factura">
            <div class="row">
                <div class="col-md-6">
                    <div class="logo-empresa"><i class="fas fa-laptop-code me-2"></i>DIGIT SOFT</div>
                    <p class="mb-1">Sistema de Gestión Empresarial</p>
                    <p class="mb-1"><i class="fas fa-phone me-2"></i>+57 300 123 4567</p>
                    <p class="mb-1"><i class="fas fa-envelope me-2"></i>info@digitsoft.com</p>
                </div>
                <div class="col-md-6 text-end">
                    <h3>FACTURA DE VENTA</h3>
                    <p class="mb-1"><strong>Nº:</strong> {{ venta.numero_venta }}</p>
                    <p class="mb-1"><strong>Fecha:</strong> {{ venta.fecha_venta|date:"d/m/Y H:i" }}</p>
                    <p class="mb-1"><strong>Estado:</strong> <span class="badge bg-success">{{ venta.get_estado_display }}</span></p>
                    <p class="mb-1"><strong>Canal:</strong> {{ venta.get_canal_venta_display }}</p>
                </div>
            </div>
        </div>

        <div class="info-factura">
            <h5 class="mb-3"><i class="fas fa-user me-2"></i>Información del Cliente</h5>
            <div class="row">
                <div class="col-md-6">
                    <p class="mb-1"><strong>Cliente:</strong> {{ venta.cliente.nombre_completo }}</p>
                    {% if venta.cliente.numero_documento %}
                    <p class="mb-1"><strong>Documento:</strong> {{ venta.cliente.numero_documento }}</p>
                    {% endif %}
                </div>
                <div class="col-md-6">
                    {% if venta.cliente.correo %}
                    <p class="mb-1"><strong>Email:</strong> {{ venta.cliente.correo }}</p>
                    {% endif %}
                    {% if venta.cliente.telefono %}
                    <p class="mb-1"><strong>Teléfono:</strong> {{ venta.cliente.telefono }}</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <h5 class="mb-3"><i class="fas fa-box me-2"></i>Detalle de Productos</h5>
        <table class="table tabla-productos">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Producto</th>
                    <th class="text-center">Cantidad</th>
                    <th class="text-end">Precio Unit.</th>
                    <th class="text-end">Subtotal</th>
                </tr>
            </thead>
            <tbody>
                {% for detalle in detalles %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td><strong>{{ detalle.producto.nombre_producto }}</strong></td>
                    <td class="text-center">{{ detalle.cantidad }}</td>
                    <td class="text-end">${{ detalle.precio_unitario|floatformat:2 }}</td>
                    <td class="text-end"><strong>${{ detalle.subtotal|floatformat:2 }}</strong></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="totales">
            <div class="row">
                <div class="col-8 text-end"><strong>Subtotal:</strong></div>
                <div class="col-4 text-end">${{ venta.subtotal|floatformat:2 }}</div>
            </div>
            <div class="row">
                <div class="col-8 text-end"><strong>IVA (19%):</strong></div>
                <div class="col-4 text-end">${{ venta.impuestos|floatformat:2 }}</div>
            </div>
            <div class="row total-final">
                <div class="col-8 text-end"><strong>TOTAL A PAGAR:</strong></div>
                <div class="col-4 text-end">${{ venta.total|floatformat:2 }}</div>
            </div>
        </div>

        <div class="info-factura mt-3">
            <div class="row">
                <div class="col-md-6">
                    <p class="mb-1"><strong>Método de Pago:</strong> {{ venta.get_metodo_pago_display }}</p>
                </div>
                <div class="col-md-6">
                    <p class="mb-1"><strong>Estado de Pago:</strong> <span class="badge bg-success">Pagado</span></p>
                </div>
            </div>
        </div>

        <div class="mt-4 text-center acciones-factura">
            <button class="btn btn-print" onclick="window.print()"><i class="fas fa-print me-2"></i>Imprimir</button>
            <a href="{% url 'ecommerce:productos' %}" class="btn btn-success"><i class="fas fa-shopping-cart me-2"></i>Seguir Comprando</a>
            <a href="{% url 'dashboard:index' %}" class="btn btn-outline-primary"><i class="fas fa-home me-2"></i>Dashboard</a>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

