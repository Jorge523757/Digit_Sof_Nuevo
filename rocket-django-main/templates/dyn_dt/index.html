<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema DigitSoft - Gestión Integral</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.0/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.0/js/bootstrap.bundle.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/11.4.8/sweetalert2.all.min.js"></script>

    <style>
        :root {
            --primary: #007bff;
            --secondary: #6c757d;
            --success: #28a745;
            --info: #17a2b8;
            --warning: #ffc107;
            --danger: #dc3545;
            --light: #f8f9fa;
            --dark: #343a40;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
        }

        .navbar-brand {
            font-weight: bold;
            color: white !important;
        }

        .navbar {
            background: rgba(0,0,0,0.8) !important;
            backdrop-filter: blur(10px);
        }

        .main-container {
            margin-top: 80px;
            padding: 20px;
        }

        .card {
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            background: rgba(255,255,255,0.9);
            border: none;
            margin-bottom: 20px;
        }

        .metric-card {
            border-radius: 15px;
            color: white;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .metric-card:hover {
            transform: translateY(-5px);
        }

        .metric-card.primary { background: linear-gradient(135deg, var(--primary), #0056b3); }
        .metric-card.success { background: linear-gradient(135deg, var(--success), #1e7e34); }
        .metric-card.warning { background: linear-gradient(135deg, var(--warning), #e0a800); }
        .metric-card.info { background: linear-gradient(135deg, var(--info), #138496); }

        .metric-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .producto-card {
            border-radius: 15px;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
            margin-bottom: 20px;
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .producto-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }

        .producto-imagen {
            width: 100%;
            height: 200px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .producto-imagen img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .producto-imagen i {
            font-size: 4rem;
            color: white;
            opacity: 0.8;
        }

        .producto-info {
            padding: 15px;
        }

        .producto-precio {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--success);
            margin: 10px 0;
        }

        .stock-alto { color: var(--success); }
        .stock-medio { color: var(--warning); }
        .stock-bajo { color: var(--danger); }

        .carrito-item {
            background: var(--light);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            border: 1px solid #dee2e6;
        }

        .quantity-control {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        .quantity-btn {
            background: var(--primary);
            border: none;
            border-radius: 5px;
            color: white;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
        }

        .quantity-btn:hover {
            background: #0056b3;
        }

        .btn-custom {
            border-radius: 25px;
            padding: 10px 25px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .tab-content-section {
            display: none;
        }

        .tab-content-section.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .categoria-filter {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .categoria-btn {
            padding: 8px 20px;
            border: 2px solid var(--primary);
            background: transparent;
            color: var(--primary);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .categoria-btn.active,
        .categoria-btn:hover {
            background: var(--primary);
            color: white;
        }

        .activity-item {
            padding: 15px;
            border-left: 4px solid var(--primary);
            background: rgba(0,123,255,0.1);
            margin-bottom: 10px;
            border-radius: 0 8px 8px 0;
        }

        .role-switcher {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(0,0,0,0.8);
            border-radius: 15px;
            padding: 15px;
            backdrop-filter: blur(10px);
        }

        .role-switcher h6 {
            color: white;
            text-align: center;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }

        .factura-container {
            background: white;
            color: #333;
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .factura-header {
            border-bottom: 2px solid var(--primary);
            padding-bottom: 20px;
            margin-bottom: 20px;
        }

        .factura-logo {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
        }

        .factura-tabla {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .factura-tabla th,
        .factura-tabla td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }

        .factura-tabla th {
            background-color: var(--light);
            font-weight: 600;
        }

        .table-dark {
            background-color: rgba(0,0,0,0.8);
            color: white;
        }

        .table-dark th {
            background-color: rgba(0,0,0,0.9);
        }

        @media (max-width: 768px) {
            .role-switcher {
                bottom: 10px;
                right: 10px;
                padding: 10px;
            }
            
            .main-container {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <a class="navbar-brand" href="#">
            <i class="fas fa-microchip"></i> DigitSoft
        </a>
        
        <div class="navbar-nav ml-auto">
            <div class="nav-item dropdown">
                <a class="nav-link dropdown-toggle text-white" href="#" id="navbarDropdown" role="button" data-toggle="dropdown">
                    <i class="fas fa-user"></i> <span id="currentUserName">Administrador</span>
                    <span class="badge badge-primary ml-2" id="currentUserRole">Admin</span>
                </a>
                <div class="dropdown-menu">
                    <a class="dropdown-item" href="#" onclick="cerrarSesion()">
                        <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Menú de navegación -->
    <div class="main-container">
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <ul class="nav nav-pills nav-fill" id="mainNav">
                            <!-- Se carga dinámicamente según el rol -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- DASHBOARD -->
        <div id="dashboard" class="tab-content-section active">
            <div class="row">
                <div class="col-md-3">
                    <div class="metric-card primary">
                        <div class="metric-value" id="totalClientes">2</div>
                        <div>Total Clientes</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card success">
                        <div class="metric-value" id="totalProductos">12</div>
                        <div>Total Productos</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card warning">
                        <div class="metric-value" id="totalEquipos">1</div>
                        <div>Equipos en Sistema</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card info">
                        <div class="metric-value" id="ventasHoy">$0</div>
                        <div>Ventas de Hoy</div>
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-clock"></i> Actividades Recientes</h5>
                        </div>
                        <div class="card-body" id="actividadesRecientes">
                            <div class="activity-item">
                                <i class="fas fa-power-off text-success mr-2"></i>
                                <strong>Sistema iniciado:</strong> DigitSoft ha sido iniciado correctamente
                                <span class="text-muted float-right">Hace un momento</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- PUNTO DE VENTA -->
        <div id="ecommerce" class="tab-content-section">
            <div class="row mb-3">
                <div class="col-md-8">
                    <h3><i class="fas fa-store"></i> Punto de Venta</h3>
                </div>
                <div class="col-md-4 text-right">
                    <button class="btn btn-info btn-custom mr-2" onclick="mostrarOrdenServicio()">
                        <i class="fas fa-clipboard-list"></i> Orden de Servicio
                    </button>
                    <button class="btn btn-success btn-custom" onclick="mostrarCarrito()">
                        <i class="fas fa-shopping-cart"></i> Carrito 
                        <span class="badge badge-light" id="carritoCount">0</span>
                    </button>
                </div>
            </div>

            <!-- Filtros de categoría -->
            <div class="categoria-filter">
                <button class="categoria-btn active" data-categoria="todas">Todas</button>
                <button class="categoria-btn" data-categoria="portatiles">Portátiles</button>
                <button class="categoria-btn" data-categoria="escritorio">Escritorio</button>
                <button class="categoria-btn" data-categoria="accesorios">Accesorios</button>
                <button class="categoria-btn" data-categoria="impresoras">Impresoras</button>
                <button class="categoria-btn" data-categoria="motos">Motos Eléctricas</button>
            </div>

            <div class="row">
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-box"></i> Productos Disponibles</h5>
                            <input type="text" id="buscarProducto" class="form-control mt-2" placeholder="Buscar producto...">
                        </div>
                        <div class="card-body" style="max-height: 600px; overflow-y: auto;">
                            <div id="productosContainer" class="row">
                                <!-- Los productos se cargarán aquí -->
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-shopping-cart"></i> Carrito de Compras</h5>
                        </div>
                        <div class="card-body" style="max-height: 500px; overflow-y: auto;">
                            <div id="carritoContainer">
                                <div class="text-center text-muted py-4">
                                    <i class="fas fa-shopping-cart fa-3x mb-3"></i>
                                    <p>El carrito está vacío</p>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer">
                            <div class="text-center">
                                <h4 class="text-success">Total: $<span id="carritoTotal">0</span></h4>
                                <button class="btn btn-success btn-block btn-custom mt-2" onclick="procesarVenta()">
                                    <i class="fas fa-credit-card"></i> Procesar Venta
                                </button>
                                <button class="btn btn-outline-secondary btn-block btn-custom mt-1" onclick="limpiarCarrito()">
                                    <i class="fas fa-broom"></i> Limpiar Carrito
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- VENTAS -->
        <div id="ventas" class="tab-content-section">
            <div class="row mb-3">
                <div class="col-md-8">
                    <h3><i class="fas fa-chart-line"></i> Gestión de Ventas</h3>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h5>Registro de Ventas</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-dark table-striped">
                            <thead>
                                <tr>
                                    <th>Producto</th>
                                    <th>Factura #</th>
                                    <th>Fecha</th>
                                    <th>Cliente</th>
                                    <th>Total</th>
                                    <th>Método Pago</th>
                                    <th>Estado</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="ventasTableBody">
                                <tr>
                                    <td colspan="7" class="text-center text-muted">No hay ventas registradas</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- PRODUCTOS -->
        <div id="productos" class="tab-content-section">
            <div class="row mb-3">
                <div class="col-md-8">
                    <h3><i class="fas fa-box"></i> Gestión de Productos</h3>
                </div>
                <div class="col-md-4 text-right">
                    <button class="btn btn-primary btn-custom" onclick="agregarProducto()">
                        <i class="fas fa-plus"></i> Agregar Producto
                    </button>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h5>Inventario de Productos</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-dark table-striped">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Imagen</th>
                                    <th>Nombre</th>
                                    <th>Categoría</th>
                                    <th>Precio</th>
                                    <th>Stock</th>
                                    <th>Proveedor</th>
                                    <th>Estado</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="productosTableBody">
                                <!-- Los productos se cargarán dinámicamente -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- EQUIPOS -->
        <div id="equipos" class="tab-content-section">
            <div class="row mb-3">
                <div class="col-md-8">
                    <h3><i class="fas fa-laptop"></i> Gestión de Equipos</h3>
                </div>
                <div class="col-md-4 text-right">
                    <button class="btn btn-primary btn-custom" onclick="mostrarOrdenServicio()">
                        <i class="fas fa-plus"></i> Ingresar Equipo
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h5>Equipos en el Sistema</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-dark table-striped">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Cliente</th>
                                    <th>Equipo</th>
                                    <th>Estado</th>
                                    <th>Técnico</th>
                                    <th>Fecha Ingreso</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="equiposTableBody">
                                <tr>
                                    <td colspan="7" class="text-center text-muted">No hay equipos registrados</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- CLIENTES -->
        <div id="clientes" class="tab-content-section">
            <div class="row mb-3">
                <div class="col-md-8">
                    <h3><i class="fas fa-users"></i> Gestión de Clientes</h3>
                </div>
                <div class="col-md-4 text-right">
                    <button class="btn btn-primary btn-custom" onclick="agregarCliente()">
                        <i class="fas fa-plus"></i> Agregar Cliente
                    </button>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h5>Lista de Clientes</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-dark table-striped">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nombre</th>
                                    <th>Email</th>
                                    <th>Teléfono</th>
                                    <th>Equipos</th>
                                    <th>Total Compras</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="clientesTableBody">
                                <tr>
                                    <td>1</td>
                                    <td>Juan Pérez</td>
                                    <td>juan@email.com</td>
                                    <td>3001234567</td>
                                    <td>1</td>
                                    <td>$0</td>
                                    <td>
                                        <button class="btn btn-sm btn-primary" onclick="verCliente(1)">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="btn btn-sm btn-warning" onclick="editarCliente(1)">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td>María García</td>
                                    <td>maria@email.com</td>
                                    <td>3109876543</td>
                                    <td>0</td>
                                    <td>$0</td>
                                    <td>
                                        <button class="btn btn-sm btn-primary" onclick="verCliente(2)">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="btn btn-sm btn-warning" onclick="editarCliente(2)">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- REPORTES -->
        <div id="reportes" class="tab-content-section">
            <div class="row mb-3">
                <div class="col-md-8">
                    <h3><i class="fas fa-chart-bar"></i> Reportes y Estadísticas</h3>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-3">
                    <div class="metric-card primary">
                        <div class="metric-value" id="reporteVentasMes">$0</div>
                        <div>Ventas del Mes</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card success">
                        <div class="metric-value" id="reporteVentasAno">$0</div>
                        <div>Ventas del Año</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card warning">
                        <div class="metric-value" id="reporteProductosBajoStock">0</div>
                        <div>Productos Bajo Stock</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card info">
                        <div class="metric-value" id="reporteEquiposPendientes">0</div>
                        <div>Equipos Pendientes</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Orden de Servicio -->
    <div class="modal fade" id="modalOrdenServicio" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-clipboard-list"></i> Orden de Servicio Técnico</h5>
                    <button type="button" class="close" data-dismiss="modal">
                        <span>&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="formOrdenServicio">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Nombre del Cliente</label>
                                    <input type="text" class="form-control" id="clienteNombre" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Teléfono</label>
                                    <input type="tel" class="form-control" id="clienteTelefono" required>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" class="form-control" id="clienteEmail">
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Tipo de Equipo</label>
                                    <select class="form-control" id="equipoTipo" required>
                                        <option value="">Seleccionar...</option>
                                        <option value="laptop">Laptop/Portátil</option>
                                        <option value="desktop">PC de Escritorio</option>
                                        <option value="impresora">Impresora</option>
                                        <option value="servidor">Servidor</option>
                                        <option value="tablet">Tablet</option>
                                        <option value="otro">Otro</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Marca</label>
                                    <input type="text" class="form-control" id="equipoMarca">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Modelo</label>
                                    <input type="text" class="form-control" id="equipoModelo">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Número de Serie</label>
                                    <input type="text" class="form-control" id="equipoSerie">
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Descripción del Problema</label>
                            <textarea class="form-control" id="equipoProblema" rows="4" placeholder="Describa detalladamente el problema presentado..." required></textarea>
                        </div>
                        <div class="form-group">
                            <label>Estado del Equipo</label>
                            <textarea class="form-control" id="equipoEstado" rows="2" placeholder="Condiciones físicas, accesorios incluidos, etc."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="crearOrdenServicio()">Crear Orden</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Selector de Roles -->
    <div class="role-switcher">
        <h6><i class="fas fa-exchange-alt"></i> CAMBIAR ROL</h6>
        <div class="btn-group-vertical btn-group-sm">
            <button class="btn btn-primary mb-1" onclick="cambiarUsuario('admin')">
                <i class="fas fa-user-shield"></i> Admin
            </button>
            <button class="btn btn-warning mb-1" onclick="cambiarUsuario('tecnico')">
                <i class="fas fa-tools"></i> Técnico
            </button>
            <button class="btn btn-success" onclick="cambiarUsuario('proveedor')">
                <i class="fas fa-truck"></i> Proveedor
            </button>
        </div>
    </div>

    <script>
        // Variables globales
        const roles = {
            ADMIN: 'admin',
            TECNICO: 'tecnico',
            PROVEEDOR: 'proveedor'
        };

        let currentUser = {
            id: 1,
            nombre: 'Administrador',
            email: 'admin@digitsoft.com',
            rol: roles.ADMIN,
            activo: true
        };

        // Base de datos con productos de tecnología
        let productos = [
            // Portátiles
            { id: 1, nombre: 'Dell Inspiron 15', categoria: 'portatiles', precio: 2500000, stock: 8, imagen: 'https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=400', descripcion: 'Laptop 15.6" Intel i5 8GB RAM 256GB SSD', proveedor: 'Dell Colombia' },
            { id: 2, nombre: 'HP Pavilion 14', categoria: 'portatiles', precio: 2200000, stock: 12, imagen: 'https://images.unsplash.com/photo-1541807084-5c52b6b3adef?w=400', descripcion: 'Laptop 14" AMD Ryzen 5 8GB RAM 512GB SSD', proveedor: 'HP Colombia' },
            { id: 3, nombre: 'Lenovo ThinkPad E15', categoria: 'portatiles', precio: 3500000, stock: 6, imagen: 'https://images.unsplash.com/photo-1588872657578-7efd1f1555ed?w=400', descripcion: 'Laptop empresarial 15.6" Intel i7 16GB RAM 1TB SSD', proveedor: 'Lenovo' },
            
            // PCs de Escritorio
            { id: 4, nombre: 'PC Gamer RTX 4060', categoria: 'escritorio', precio: 4500000, stock: 5, imagen: 'https://images.unsplash.com/photo-1587202372634-32705e3bf49c?w=400', descripcion: 'PC Gaming Intel i5 16GB RTX 4060 1TB SSD', proveedor: 'TechBuild' },
            { id: 5, nombre: 'PC Oficina Intel i3', categoria: 'escritorio', precio: 1800000, stock: 10, imagen: 'https://images.unsplash.com/photo-1593640408182-31174390b5f0?w=400', descripcion: 'PC Básico Intel i3 8GB RAM 500GB HDD', proveedor: 'OfficePC' },
            { id: 6, nombre: 'Workstation Dell', categoria: 'escritorio', precio: 6500000, stock: 3, imagen: 'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400', descripcion: 'Estación de trabajo Intel Xeon 32GB RAM Quadro', proveedor: 'Dell Colombia' },
            
            // Accesorios
            { id: 7, nombre: 'Teclado Mecánico RGB', categoria: 'accesorios', precio: 280000, stock: 15, imagen: 'https://images.unsplash.com/photo-1541140532154-b024d705b90a?w=400', descripcion: 'Teclado mecánico switches azules RGB', proveedor: 'Gaming Gear' },
            { id: 8, nombre: 'Mouse Gaming 12000 DPI', categoria: 'accesorios', precio: 150000, stock: 20, imagen: 'https://images.unsplash.com/photo-1527864550417-7fd91fc51a46?w=400', descripcion: 'Mouse óptico gaming alta precisión RGB', proveedor: 'Gaming Gear' },
            { id: 9, nombre: 'Monitor 24" Full HD', categoria: 'accesorios', precio: 650000, stock: 8, imagen: 'https://images.unsplash.com/photo-1527443224154-c4a3942d3acf?w=400', descripcion: 'Monitor LED 24 pulgadas 1920x1080 75Hz', proveedor: 'Monitor Pro' },
            
            // Impresoras
            { id: 10, nombre: 'Impresora HP LaserJet', categoria: 'impresoras', precio: 850000, stock: 7, imagen: 'https://images.unsplash.com/photo-1612815154858-60aa4c59eaa6?w=400', descripcion: 'Impresora láser monocromática WiFi', proveedor: 'HP Colombia' },
            { id: 11, nombre: 'Multifuncional Canon', categoria: 'impresoras', precio: 420000, stock: 9, imagen: 'https://images.unsplash.com/photo-1606663889134-b1dedb5ed8b7?w=400', descripcion: 'Impresora multifuncional tinta color WiFi', proveedor: 'Canon Colombia' },
            
            // Motos Eléctricas
            { id: 12, nombre: 'Moto Eléctrica Urban', categoria: 'motos', precio: 8500000, stock: 4, imagen: 'https://images.unsplash.com/photo-1571068316344-75bc76f77890?w=400', descripcion: 'Moto eléctrica 60km autonomía velocidad 45km/h', proveedor: 'EcoMoto' }
        ];

        let clientes = [
            { id: 1, nombre: 'Juan Pérez', email: 'juan@email.com', telefono: '3001234567', direccion: 'Calle 123 #45-67', totalCompras: 0, equipos: 1 },
            { id: 2, nombre: 'María García', email: 'maria@email.com', telefono: '3109876543', direccion: 'Carrera 15 #32-45', totalCompras: 0, equipos: 0 }
        ];

        let carrito = [];
        let ventasHistorial = [];
        let actividades = [];
        let ordenesServicio = [];

        // Configuración de menús por rol
        const menusPorRol = {
            [roles.ADMIN]: [
                { id: 'dashboard', text: 'Dashboard', icon: 'fas fa-tachometer-alt' },
                { id: 'ecommerce', text: 'Punto de Venta', icon: 'fas fa-store' },
                { id: 'ventas', text: 'Ventas', icon: 'fas fa-chart-line' },
                { id: 'productos', text: 'Productos', icon: 'fas fa-box' },
                { id: 'equipos', text: 'Equipos', icon: 'fas fa-laptop' },
                { id: 'clientes', text: 'Clientes', icon: 'fas fa-users' },
                { id: 'reportes', text: 'Reportes', icon: 'fas fa-chart-bar' }
            ],
            [roles.TECNICO]: [
                { id: 'dashboard', text: 'Dashboard', icon: 'fas fa-tachometer-alt' },
                { id: 'equipos', text: 'Equipos', icon: 'fas fa-laptop' },
                { id: 'clientes', text: 'Clientes', icon: 'fas fa-users' }
            ],
            [roles.PROVEEDOR]: [
                { id: 'dashboard', text: 'Dashboard', icon: 'fas fa-tachometer-alt' },
                { id: 'productos', text: 'Mis Productos', icon: 'fas fa-box' },
                { id: 'ventas', text: 'Mis Ventas', icon: 'fas fa-chart-line' }
            ]
        };

        // Inicialización
        $(document).ready(function() {
            inicializarSistema();
            cargarMenuSegunRol();
            actualizarInfoUsuario();
            cargarProductos();
            configurarEventos();
            inicializarDatos();
        });

        function inicializarSistema() {
            agregarActividad(
                'Sistema iniciado',
                'DigitSoft ha sido iniciado correctamente',
                'fas fa-power-off',
                'text-success'
            );
        }

        function cargarMenuSegunRol() {
            const menu = $('#mainNav');
            menu.empty();
            
            const menus = menusPorRol[currentUser.rol] || menusPorRol[roles.ADMIN];
            
            menus.forEach((item, index) => {
                const activeClass = index === 0 ? 'active' : '';
                menu.append(`
                    <li class="nav-item">
                        <a class="nav-link ${activeClass}" href="#" data-tab="${item.id}">
                            <i class="${item.icon}"></i> ${item.text}
                        </a>
                    </li>
                `);
            });
        }

        function actualizarInfoUsuario() {
            $('#currentUserName').text(currentUser.nombre);
            
            const roleLabels = {
                [roles.ADMIN]: 'Admin',
                [roles.TECNICO]: 'Técnico',
                [roles.PROVEEDOR]: 'Proveedor'
            };
            
            $('#currentUserRole').text(roleLabels[currentUser.rol]);
        }

        function configurarEventos() {
            // Navegación
            $(document).on('click', '.nav-link', function(e) {
                e.preventDefault();
                const tab = $(this).data('tab');
                if (tab) {
                    mostrarTab(tab);
                }
            });

            // Filtros de categoría
            $('.categoria-btn').on('click', function() {
                $('.categoria-btn').removeClass('active');
                $(this).addClass('active');
                const categoria = $(this).data('categoria');
                filtrarProductos(categoria);
            });

            // Búsqueda de productos
            $('#buscarProducto').on('keyup', function() {
                const termino = $(this).val().toLowerCase();
                buscarProductos(termino);
            });
        }

        function mostrarTab(tabName) {
            $('.tab-content-section').removeClass('active');
            $('.nav-link').removeClass('active');
            
            $(`#${tabName}`).addClass('active');
            $(`.nav-link[data-tab="${tabName}"]`).addClass('active');
            
            // Cargar contenido específico
            switch(tabName) {
                case 'ecommerce':
                    cargarProductos();
                    break;
                case 'ventas':
                    cargarVentasTabla();
                    break;
                case 'productos':
                    cargarProductosTabla();
                    break;
                case 'equipos':
                    actualizarTablaEquipos();
                    break;
                case 'reportes':
                    actualizarReportes();
                    break;
            }
        }

        function filtrarProductos(categoria) {
            let productosFiltrados = productos;
            if (categoria !== 'todas') {
                productosFiltrados = productos.filter(p => p.categoria === categoria);
            }
            mostrarProductos(productosFiltrados);
        }

        function buscarProductos(termino) {
            const productosFiltrados = productos.filter(p => 
                p.nombre.toLowerCase().includes(termino) || 
                p.descripcion.toLowerCase().includes(termino)
            );
            mostrarProductos(productosFiltrados);
        }

        function cargarProductos() {
            let productosPermitidos = productos;
            
            if (currentUser.rol === roles.PROVEEDOR) {
                productosPermitidos = productos.filter(p => p.proveedor.includes('TechSupply'));
            }
            
            mostrarProductos(productosPermitidos);
        }

        function mostrarProductos(listaProductos) {
            const container = $('#productosContainer');
            container.empty();

            if (listaProductos.length === 0) {
                container.html(`
                    <div class="col-12 text-center text-muted py-5">
                        <i class="fas fa-search fa-3x mb-3"></i>
                        <h5>No se encontraron productos</h5>
                    </div>
                `);
                return;
            }

            listaProductos.forEach(producto => {
                const stockClass = producto.stock > 10 ? 'stock-alto' : (producto.stock > 5 ? 'stock-medio' : 'stock-bajo');
                const canBuy = currentUser.rol === roles.ADMIN && producto.stock > 0;
                
                const productoHtml = `
                    <div class="col-md-4 mb-3">
                        <div class="producto-card ${canBuy ? '' : 'disabled'}" ${canBuy ? `onclick="agregarAlCarrito(${producto.id})"` : ''}>
                            <div class="producto-imagen">
                                <img src="${producto.imagen}" alt="${producto.nombre}" 
                                     onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <i class="fas fa-laptop"></i>
                            </div>
                            <div class="producto-info">
                                <h6>${producto.nombre}</h6>
                                <small class="text-muted">${producto.descripcion}</small>
                                <div class="producto-precio">${producto.precio.toLocaleString()}</div>
                                <div class="${stockClass}">
                                    <i class="fas fa-box"></i> Stock: ${producto.stock}
                                </div>
                                <small class="text-info">${producto.proveedor}</small>
                            </div>
                        </div>
                    </div>
                `;
                container.append(productoHtml);
            });
        }

        function agregarAlCarrito(productoId) {
            if (currentUser.rol !== roles.ADMIN) {
                Swal.fire('Acceso Restringido', 'Solo administradores pueden realizar ventas', 'warning');
                return;
            }

            const producto = productos.find(p => p.id === productoId);
            if (!producto || producto.stock === 0) {
                Swal.fire('Error', 'Producto sin stock disponible', 'error');
                return;
            }

            const itemExistente = carrito.find(item => item.id === productoId);
            
            if (itemExistente) {
                if (itemExistente.cantidad < producto.stock) {
                    itemExistente.cantidad++;
                } else {
                    Swal.fire('Advertencia', 'No hay más stock disponible', 'warning');
                    return;
                }
            } else {
                carrito.push({
                    id: producto.id,
                    nombre: producto.nombre,
                    precio: producto.precio,
                    cantidad: 1,
                    stock: producto.stock
                });
            }

            actualizarCarrito();
            Swal.fire({
                icon: 'success',
                title: 'Agregado',
                text: `${producto.nombre} agregado al carrito`,
                timer: 1500,
                showConfirmButton: false
            });
        }

        function actualizarCarrito() {
            const container = $('#carritoContainer');
            const count = $('#carritoCount');
            
            if (carrito.length === 0) {
                container.html(`
                    <div class="text-center text-muted py-4">
                        <i class="fas fa-shopping-cart fa-3x mb-3"></i>
                        <p>El carrito está vacío</p>
                    </div>
                `);
                count.text('0');
                $('#carritoTotal').text('0');
                return;
            }

            let carritoHtml = '';
            let total = 0;
            let totalItems = 0;

            carrito.forEach((item, index) => {
                const subtotal = item.precio * item.cantidad;
                total += subtotal;
                totalItems += item.cantidad;

                carritoHtml += `
                    <div class="carrito-item">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <strong>${item.nombre}</strong><br>
                                <small class="text-muted">${item.precio.toLocaleString()} c/u</small>
                            </div>
                            <button class="btn btn-sm btn-danger" onclick="eliminarDelCarrito(${index})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                        <div class="quantity-control">
                            <button class="quantity-btn" onclick="cambiarCantidad(${index}, -1)">-</button>
                            <span class="mx-3 font-weight-bold">${item.cantidad}</span>
                            <button class="quantity-btn" onclick="cambiarCantidad(${index}, 1)">+</button>
                        </div>
                        <div class="text-right mt-2">
                            <strong class="text-success">${subtotal.toLocaleString()}</strong>
                        </div>
                    </div>
                `;
            });

            container.html(carritoHtml);
            count.text(totalItems);
            $('#carritoTotal').text(total.toLocaleString());
        }

        function cambiarCantidad(index, cambio) {
            const item = carrito[index];
            const nuevaCantidad = item.cantidad + cambio;
            
            if (nuevaCantidad < 1) return;
            if (nuevaCantidad > item.stock) {
                Swal.fire('Advertencia', 'No hay más stock disponible', 'warning');
                return;
            }
            
            item.cantidad = nuevaCantidad;
            actualizarCarrito();
        }

        function eliminarDelCarrito(index) {
            carrito.splice(index, 1);
            actualizarCarrito();
        }

        function limpiarCarrito() {
            if (carrito.length === 0) return;
            
            Swal.fire({
                title: '¿Limpiar carrito?',
                text: 'Se eliminarán todos los productos',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonText: 'Sí, limpiar',
                cancelButtonText: 'Cancelar'
            }).then((result) => {
                if (result.isConfirmed) {
                    carrito = [];
                    actualizarCarrito();
                }
            });
        }

        function procesarVenta() {
            if (carrito.length === 0) {
                Swal.fire('Error', 'El carrito está vacío', 'error');
                return;
            }

            const total = carrito.reduce((sum, item) => sum + (item.precio * item.cantidad), 0);
            
            Swal.fire({
                title: 'Procesar Venta',
                html: `
                    <div class="text-left">
                        <h6>Resumen de la compra:</h6>
                        ${carrito.map(item => `
                            <div class="d-flex justify-content-between mb-1">
                                <span>${item.nombre} x${item.cantidad}</span>
                                <span>${(item.precio * item.cantidad).toLocaleString()}</span>
                            </div>
                        `).join('')}
                        <hr>
                        <div class="d-flex justify-content-between">
                            <strong>Total: ${total.toLocaleString()}</strong>
                        </div>
                        <div class="form-group mt-3">
                            <label>Cliente:</label>
                            <input type="text" class="form-control" id="ventaCliente" placeholder="Nombre del cliente" value="Cliente General">
                        </div>
                        <div class="form-group">
                            <label>Método de Pago:</label>
                            <select class="form-control" id="metodoPago">
                                <option value="efectivo">Efectivo</option>
                                <option value="tarjeta">Tarjeta</option>
                                <option value="transferencia">Transferencia</option>
                            </select>
                        </div>
                    </div>
                `,
                showCancelButton: true,
                confirmButtonText: 'Confirmar Venta',
                cancelButtonText: 'Cancelar',
                preConfirm: () => {
                    return {
                        cliente: document.getElementById('ventaCliente').value,
                        metodoPago: document.getElementById('metodoPago').value
                    };
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    confirmarVenta(result.value);
                }
            });
        }

        function confirmarVenta(datosVenta) {
            const total = carrito.reduce((sum, item) => sum + (item.precio * item.cantidad), 0);
            const facturaId = 'F' + Date.now().toString().slice(-6);
            const fecha = new Date();
            
            // Actualizar stock
            carrito.forEach(item => {
                const producto = productos.find(p => p.id === item.id);
                if (producto) {
                    producto.stock -= item.cantidad;
                }
            });

            // Crear venta
            const venta = {
                id: facturaId,
                fecha,
                cliente: datosVenta.cliente,
                items: [...carrito],
                subtotal: total,
                iva: Math.round(total * 0.19),
                total: Math.round(total * 1.19),
                metodoPago: datosVenta.metodoPago,
                estado: 'completada',
                vendedor: currentUser.nombre
            };

            ventasHistorial.push(venta);
            carrito = [];
            actualizarCarrito();
            cargarProductos();
            actualizarMetricas();

            agregarActividad(
                'Nueva venta',
                `Factura ${facturaId} por ${venta.total.toLocaleString()}`,
                'fas fa-shopping-cart',
                'text-success'
            );

            mostrarFactura(venta);
        }

        function mostrarFactura(venta) {
            const facturaHtml = `
                <div class="factura-container">
                    <div class="factura-header">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="factura-logo">
                                    <i class="fas fa-microchip"></i> DigitSoft
                                </div>
                                <p>Sistema de Gestión Integral<br>
                                NIT: 900.123.456-7<br>
                                Bogotá, Colombia</p>
                            </div>
                            <div class="col-md-6 text-right">
                                <h4>FACTURA DE VENTA</h4>
                                <p><strong>No. ${venta.id}</strong><br>
                                Fecha: ${venta.fecha.toLocaleDateString()}<br>
                                Hora: ${venta.fecha.toLocaleTimeString()}</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <div class="row">
                            <div class="col-md-6">
                                <strong>Cliente:</strong> ${venta.cliente}<br>
                                <strong>Método de Pago:</strong> ${venta.metodoPago}
                            </div>
                            <div class="col-md-6 text-right">
                                <strong>Vendedor:</strong> ${venta.vendedor}
                            </div>
                        </div>
                    </div>
                    
                    <table class="factura-tabla">
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>Cant.</th>
                                <th>Precio Unit.</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${venta.items.map(item => `
                                <tr>
                                    <td>${item.nombre}</td>
                                    <td>${item.cantidad}</td>
                                    <td>${item.precio.toLocaleString()}</td>
                                    <td>${(item.precio * item.cantidad).toLocaleString()}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                    
                    <div class="text-right">
                        <p>Subtotal: ${venta.subtotal.toLocaleString()}</p>
                        <p>IVA (19%): ${venta.iva.toLocaleString()}</p>
                        <h4><strong>TOTAL: ${venta.total.toLocaleString()}</strong></h4>
                    </div>
                    
                    <div class="text-center mt-4">
                        <p><strong>¡Gracias por su compra!</strong></p>
                    </div>
                </div>
            `;

            Swal.fire({
                title: 'Factura Generada',
                html: facturaHtml,
                width: '800px',
                showCancelButton: true,
                confirmButtonText: 'Imprimir',
                cancelButtonText: 'Cerrar'
            }).then((result) => {
                if (result.isConfirmed) {
                    window.print();
                }
            });
        }

        function cargarVentasTabla() {
            const tbody = $('#ventasTableBody');
            tbody.empty();

            if (ventasHistorial.length === 0) {
                tbody.append(`
                    <tr>
                        <td colspan="7" class="text-center">No hay ventas registradas</td>
                    </tr>
                `);
                return;
            }

            ventasHistorial.forEach(venta => {
                tbody.append(`
                    <tr>
                        <td>${venta.id}</td>
                        <td>${venta.fecha.toLocaleDateString()}</td>
                        <td>${venta.cliente}</td>
                        <td>${venta.total.toLocaleString()}</td>
                        <td>${venta.metodoPago}</td>
                        <td><span class="badge badge-success">${venta.estado}</span></td>
                        <td>
                            <button class="btn btn-sm btn-primary" onclick="verVenta('${venta.id}')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                `);
            });
        }

        function cargarProductosTabla() {
            const tbody = $('#productosTableBody');
            tbody.empty();

            let productosAMostrar = productos;
            if (currentUser.rol === roles.PROVEEDOR) {
                productosAMostrar = productos.filter(p => p.proveedor.includes('TechSupply'));
            }

            productosAMostrar.forEach(producto => {
                let estadoClass = 'success';
                let estadoTexto = 'Disponible';
                
                if (producto.stock === 0) {
                    estadoClass = 'danger';
                    estadoTexto = 'Sin stock';
                } else if (producto.stock <= 5) {
                    estadoClass = 'warning';
                    estadoTexto = 'Stock bajo';
                }

                tbody.append(`
                    <tr>
                        <td>${producto.id}</td>
                        <td>
                            <img src="${producto.imagen}" alt="${producto.nombre}" 
                                 style="width: 60px; height: 60px; object-fit: cover; border-radius: 8px;">
                        </td>
                        <td>${producto.nombre}</td>
                        <td>${producto.categoria}</td>
                        <td>${producto.precio.toLocaleString()}</td>
                        <td>${producto.stock}</td>
                        <td>${producto.proveedor}</td>
                        <td><span class="badge badge-${estadoClass}">${estadoTexto}</span></td>
                        <td>
                            <button class="btn btn-sm btn-warning" onclick="editarProducto(${producto.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            ${currentUser.rol === roles.ADMIN ? 
                                `<button class="btn btn-sm btn-danger ml-1" onclick="eliminarProducto(${producto.id})">
                                    <i class="fas fa-trash"></i>
                                </button>` : ''
                            }
                        </td>
                    </tr>
                `);
            });
        }

        function mostrarOrdenServicio() {
            $('#modalOrdenServicio').modal('show');
        }

        function crearOrdenServicio() {
            const form = document.getElementById('formOrdenServicio');
            const formData = new FormData(form);
            
            const clienteNombre = $('#clienteNombre').val();
            const clienteTelefono = $('#clienteTelefono').val();
            const equipoTipo = $('#equipoTipo').val();
            const equipoProblema = $('#equipoProblema').val();

            if (!clienteNombre || !clienteTelefono || !equipoTipo || !equipoProblema) {
                Swal.fire('Error', 'Complete los campos obligatorios', 'error');
                return;
            }

            const ordenId = 'OS' + Date.now().toString().slice(-6);
            const orden = {
                id: ordenId,
                fecha: new Date(),
                cliente: {
                    nombre: clienteNombre,
                    telefono: clienteTelefono,
                    email: $('#clienteEmail').val()
                },
                equipo: {
                    tipo: equipoTipo,
                    marca: $('#equipoMarca').val(),
                    modelo: $('#equipoModelo').val(),
                    serie: $('#equipoSerie').val(),
                    problema: equipoProblema,
                    estado: $('#equipoEstado').val()
                },
                estado: 'recibido',
                tecnico: currentUser.rol === roles.TECNICO ? currentUser.nombre : null
            };

            ordenesServicio.push(orden);
            form.reset();
            $('#modalOrdenServicio').modal('hide');

            agregarActividad(
                'Orden creada',
                `${ordenId} - ${clienteNombre}`,
                'fas fa-clipboard-list',
                'text-info'
            );

            Swal.fire('Éxito', `Orden ${ordenId} creada exitosamente`, 'success');
            actualizarTablaEquipos();
        }

        function actualizarTablaEquipos() {
            const tbody = $('#equiposTableBody');
            tbody.empty();

            if (ordenesServicio.length === 0) {
                tbody.append(`
                    <tr>
                        <td colspan="7" class="text-center">No hay equipos registrados</td>
                    </tr>
                `);
                return;
            }

            ordenesServicio.forEach(orden => {
                const estadoClass = {
                    'recibido': 'info',
                    'diagnostico': 'warning', 
                    'reparacion': 'primary',
                    'completado': 'success',
                    'entregado': 'secondary'
                }[orden.estado] || 'info';

                tbody.append(`
                    <tr>
                        <td>${orden.id}</td>
                        <td>${orden.cliente.nombre}</td>
                        <td>${orden.equipo.marca || 'N/A'} ${orden.equipo.modelo || ''}</td>
                        <td><span class="badge badge-${estadoClass}">${orden.estado}</span></td>
                        <td>${orden.tecnico || 'Sin asignar'}</td>
                        <td>${orden.fecha.toLocaleDateString()}</td>
                        <td>
                            <button class="btn btn-sm btn-primary" onclick="verEquipo('${orden.id}')">
                                <i class="fas fa-eye"></i>
                            </button>
                            ${currentUser.rol !== roles.PROVEEDOR ?
                                `<button class="btn btn-sm btn-warning ml-1" onclick="editarEquipo('${orden.id}')">
                                    <i class="fas fa-edit"></i>
                                </button>` : ''
                            }
                        </td>
                    </tr>
                `);
            });
        }

        function mostrarCarrito() {
            if (carrito.length === 0) {
                Swal.fire('Info', 'El carrito está vacío', 'info');
                return;
            }

            let carritoHtml = '<div class="text-left">';
            let total = 0;
            
            carrito.forEach(item => {
                const subtotal = item.precio * item.cantidad;
                total += subtotal;
                carritoHtml += `
                    <div class="d-flex justify-content-between mb-2">
                        <div>
                            <strong>${item.nombre}</strong><br>
                            <small>${item.precio.toLocaleString()} x ${item.cantidad}</small>
                        </div>
                        <div>${subtotal.toLocaleString()}</div>
                    </div>
                `;
            });
            
            carritoHtml += `<hr><div class="d-flex justify-content-between"><strong>Total: ${total.toLocaleString()}</strong></div></div>`;

            Swal.fire({
                title: 'Carrito de Compras',
                html: carritoHtml,
                width: '500px',
                showCancelButton: true,
                confirmButtonText: 'Procesar Venta',
                cancelButtonText: 'Cerrar'
            }).then((result) => {
                if (result.isConfirmed) {
                    procesarVenta();
                }
            });
        }

        function agregarActividad(titulo, descripcion, icono, color) {
            actividades.push({
                titulo,
                descripcion,
                icono,
                color,
                fecha: new Date()
            });
            
            if (actividades.length > 10) {
                actividades = actividades.slice(-10);
            }
            
            mostrarActividades();
        }

        function mostrarActividades() {
            const container = $('#actividadesRecientes');
            
            let actividadesHtml = '';
            const actividadesRecientes = actividades.slice(-5).reverse();
            
            if (actividadesRecientes.length === 0) {
                actividadesHtml = `
                    <div class="activity-item">
                        <i class="fas fa-power-off text-success mr-2"></i>
                        <strong>Sistema iniciado:</strong> DigitSoft ha sido iniciado correctamente
                        <span class="text-muted float-right">Hace un momento</span>
                    </div>
                `;
            } else {
                actividadesRecientes.forEach(actividad => {
                    const tiempo = timeAgo(actividad.fecha);
                    actividadesHtml += `
                        <div class="activity-item">
                            <i class="${actividad.icono} ${actividad.color} mr-2"></i>
                            <strong>${actividad.titulo}:</strong> ${actividad.descripcion}
                            <span class="text-muted float-right">${tiempo}</span>
                        </div>
                    `;
                });
            }
            
            container.html(actividadesHtml);
        }

        function timeAgo(fecha) {
            const ahora = new Date();
            const diff = Math.floor((ahora - fecha) / 1000);
            
            if (diff < 60) return 'Hace un momento';
            if (diff < 3600) return `Hace ${Math.floor(diff / 60)} min`;
            if (diff < 86400) return `Hace ${Math.floor(diff / 3600)} horas`;
            return `Hace ${Math.floor(diff / 86400)} días`;
        }

        function actualizarMetricas() {
            $('#totalClientes').text(clientes.length);
            $('#totalProductos').text(productos.length);
            $('#totalEquipos').text(ordenesServicio.length);
            
            const hoy = new Date().toDateString();
            const ventasHoy = ventasHistorial.filter(v => v.fecha.toDateString() === hoy);
            const totalVentasHoy = ventasHoy.reduce((sum, v) => sum + v.total, 0);
            $('#ventasHoy').text(`${totalVentasHoy.toLocaleString()}`);
        }

        function actualizarReportes() {
            const mesActual = new Date().getMonth();
            const anoActual = new Date().getFullYear();
            
            const ventasMes = ventasHistorial.filter(v => 
                v.fecha.getMonth() === mesActual && v.fecha.getFullYear() === anoActual
            );
            const totalVentasMes = ventasMes.reduce((sum, v) => sum + v.total, 0);
            
            const ventasAno = ventasHistorial.filter(v => v.fecha.getFullYear() === anoActual);
            const totalVentasAno = ventasAno.reduce((sum, v) => sum + v.total, 0);
            
            const productosBajoStock = productos.filter(p => p.stock <= 5).length;
            const equiposPendientes = ordenesServicio.filter(o => o.estado !== 'entregado').length;
            
            $('#reporteVentasMes').text(`${totalVentasMes.toLocaleString()}`);
            $('#reporteVentasAno').text(`${totalVentasAno.toLocaleString()}`);
            $('#reporteProductosBajoStock').text(productosBajoStock);
            $('#reporteEquiposPendientes').text(equiposPendientes);
        }

        function cambiarUsuario(nuevoRol) {
            const usuarios = {
                [roles.ADMIN]: { id: 1, nombre: 'Administrador', email: 'admin@digitsoft.com', rol: roles.ADMIN },
                [roles.TECNICO]: { id: 2, nombre: 'Juan Martínez', email: 'tecnico@digitsoft.com', rol: roles.TECNICO },
                [roles.PROVEEDOR]: { id: 3, nombre: 'TechSupply', email: 'proveedor@techsupply.com', rol: roles.PROVEEDOR }
            };

            currentUser = usuarios[nuevoRol];
            cargarMenuSegunRol();
            actualizarInfoUsuario();
            mostrarTab('dashboard');

            // Limpiar carrito al cambiar usuario
            carrito = [];
            actualizarCarrito();

            Swal.fire({
                icon: 'info',
                title: 'Usuario cambiado',
                text: `Ahora eres: ${currentUser.nombre}`,
                timer: 1500,
                showConfirmButton: false
            });
        }

        // Funciones adicionales
        function verVenta(ventaId) {
            const venta = ventasHistorial.find(v => v.id === ventaId);
            if (venta) {
                mostrarFactura(venta);
            }
        }

        function verEquipo(ordenId) {
            const orden = ordenesServicio.find(o => o.id === ordenId);
            if (!orden) return;

            Swal.fire({
                title: `Equipo ${orden.id}`,
                html: `
                    <div class="text-left">
                        <h6>Cliente:</h6>
                        <p><strong>Nombre:</strong> ${orden.cliente.nombre}</p>
                        <p><strong>Teléfono:</strong> ${orden.cliente.telefono}</p>
                        <p><strong>Email:</strong> ${orden.cliente.email || 'No especificado'}</p>
                        
                        <h6>Equipo:</h6>
                        <p><strong>Tipo:</strong> ${orden.equipo.tipo}</p>
                        <p><strong>Marca:</strong> ${orden.equipo.marca || 'No especificado'}</p>
                        <p><strong>Modelo:</strong> ${orden.equipo.modelo || 'No especificado'}</p>
                        <p><strong>Serie:</strong> ${orden.equipo.serie || 'No especificado'}</p>
                        <p><strong>Problema:</strong> ${orden.equipo.problema}</p>
                        
                        <h6>Estado:</h6>
                        <p><strong>Estado actual:</strong> ${orden.estado}</p>
                        <p><strong>Técnico:</strong> ${orden.tecnico || 'Sin asignar'}</p>
                        <p><strong>Ingreso:</strong> ${orden.fecha.toLocaleDateString()}</p>
                    </div>
                `,
                width: '600px',
                confirmButtonText: 'Cerrar'
            });
        }

        function editarEquipo(ordenId) {
            const orden = ordenesServicio.find(o => o.id === ordenId);
            if (!orden) return;

            Swal.fire({
                title: 'Actualizar Estado',
                html: `
                    <div class="form-group text-left">
                        <label>Estado:</label>
                        <select class="form-control" id="nuevoEstado">
                            <option value="recibido" ${orden.estado === 'recibido' ? 'selected' : ''}>Recibido</option>
                            <option value="diagnostico" ${orden.estado === 'diagnostico' ? 'selected' : ''}>En Diagnóstico</option>
                            <option value="reparacion" ${orden.estado === 'reparacion' ? 'selected' : ''}>En Reparación</option>
                            <option value="completado" ${orden.estado === 'completado' ? 'selected' : ''}>Completado</option>
                            <option value="entregado" ${orden.estado === 'entregado' ? 'selected' : ''}>Entregado</option>
                        </select>
                    </div>
                    <div class="form-group text-left">
                        <label>Técnico:</label>
                        <select class="form-control" id="nuevoTecnico">
                            <option value="">Sin asignar</option>
                            <option value="Juan Martínez" ${orden.tecnico === 'Juan Martínez' ? 'selected' : ''}>Juan Martínez</option>
                            <option value="Ana García" ${orden.tecnico === 'Ana García' ? 'selected' : ''}>Ana García</option>
                            <option value="Carlos López" ${orden.tecnico === 'Carlos López' ? 'selected' : ''}>Carlos López</option>
                        </select>
                    </div>
                `,
                showCancelButton: true,
                confirmButtonText: 'Actualizar',
                preConfirm: () => {
                    return {
                        estado: document.getElementById('nuevoEstado').value,
                        tecnico: document.getElementById('nuevoTecnico').value
                    };
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    orden.estado = result.value.estado;
                    orden.tecnico = result.value.tecnico || null;
                    
                    actualizarTablaEquipos();
                    agregarActividad(
                        'Equipo actualizado',
                        `${orden.id} - ${result.value.estado}`,
                        'fas fa-edit',
                        'text-warning'
                    );
                    
                    Swal.fire('Actualizado', 'Estado del equipo actualizado', 'success');
                }
            });
        }

        function agregarProducto() {
            if (currentUser.rol === roles.TECNICO) {
                Swal.fire('Acceso Restringido', 'Los técnicos no pueden agregar productos', 'warning');
                return;
            }

            Swal.fire({
                title: 'Nuevo Producto',
                html: `
                    <div class="form-group text-left">
                        <label>Nombre:</label>
                        <input type="text" class="form-control" id="newNombre" required>
                    </div>
                    <div class="form-group text-left">
                        <label>Categoría:</label>
                        <select class="form-control" id="newCategoria" required>
                            <option value="">Seleccionar...</option>
                            <option value="portatiles">Portátiles</option>
                            <option value="escritorio">Escritorio</option>
                            <option value="accesorios">Accesorios</option>
                            <option value="impresoras">Impresoras</option>
                            <option value="motos">Motos Eléctricas</option>
                        </select>
                    </div>
                    <div class="form-group text-left">
                        <label>Precio:</label>
                        <input type="number" class="form-control" id="newPrecio" required>
                    </div>
                    <div class="form-group text-left">
                        <label>Stock:</label>
                        <input type="number" class="form-control" id="newStock" required>
                    </div>
                    <div class="form-group text-left">
                        <label>URL Imagen:</label>
                        <input type="url" class="form-control" id="newImagen">
                    </div>
                    <div class="form-group text-left">
                        <label>Descripción:</label>
                        <textarea class="form-control" id="newDescripcion" rows="3"></textarea>
                    </div>
                `,
                showCancelButton: true,
                confirmButtonText: 'Agregar',
                preConfirm: () => {
                    const nombre = document.getElementById('newNombre').value;
                    const categoria = document.getElementById('newCategoria').value;
                    const precio = document.getElementById('newPrecio').value;
                    const stock = document.getElementById('newStock').value;
                    
                    if (!nombre || !categoria || !precio || !stock) {
                        Swal.showValidationMessage('Complete todos los campos obligatorios');
                        return false;
                    }
                    
                    return {
                        nombre,
                        categoria,
                        precio: parseInt(precio),
                        stock: parseInt(stock),
                        imagen: document.getElementById('newImagen').value || 'https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=400',
                        descripcion: document.getElementById('newDescripcion').value,
                        proveedor: currentUser.nombre
                    };
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    const nuevoProducto = {
                        id: Math.max(...productos.map(p => p.id)) + 1,
                        ...result.value
                    };
                    
                    productos.push(nuevoProducto);
                    cargarProductosTabla();
                    cargarProductos();
                    actualizarMetricas();
                    
                    agregarActividad(
                        'Producto agregado',
                        `${nuevoProducto.nombre}`,
                        'fas fa-plus',
                        'text-success'
                    );
                    
                    Swal.fire('Éxito', 'Producto agregado correctamente', 'success');
                }
            });
        }

        function editarProducto(productoId) {
            const producto = productos.find(p => p.id === productoId);
            if (!producto) return;

            if (currentUser.rol === roles.PROVEEDOR && !producto.proveedor.includes(currentUser.nombre)) {
                Swal.fire('Acceso Restringido', 'Solo puedes editar tus productos', 'warning');
                return;
            }

            Swal.fire({
                title: 'Editar Producto',
                html: `
                    <div class="form-group text-left">
                        <label>Nombre:</label>
                        <input type="text" class="form-control" id="editNombre" value="${producto.nombre}">
                    </div>
                    <div class="form-group text-left">
                        <label>Precio:</label>
                        <input type="number" class="form-control" id="editPrecio" value="${producto.precio}">
                    </div>
                    <div class="form-group text-left">
                        <label>Stock:</label>
                        <input type="number" class="form-control" id="editStock" value="${producto.stock}">
                    </div>
                    <div class="form-group text-left">
                        <label>Descripción:</label>
                        <textarea class="form-control" id="editDescripcion">${producto.descripcion}</textarea>
                    </div>
                `,
                showCancelButton: true,
                confirmButtonText: 'Guardar',
                preConfirm: () => {
                    return {
                        nombre: document.getElementById('editNombre').value,
                        precio: parseInt(document.getElementById('editPrecio').value),
                        stock: parseInt(document.getElementById('editStock').value),
                        descripcion: document.getElementById('editDescripcion').value
                    };
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    producto.nombre = result.value.nombre;
                    producto.precio = result.value.precio;
                    producto.stock = result.value.stock;
                    producto.descripcion = result.value.descripcion;
                    
                    cargarProductosTabla();
                    cargarProductos();
                    
                    agregarActividad(
                        'Producto editado',
                        `${producto.nombre}`,
                        'fas fa-edit',
                        'text-info'
                    );
                    
                    Swal.fire('Actualizado', 'Producto actualizado correctamente', 'success');
                }
            });
        }

        function eliminarProducto(productoId) {
            if (currentUser.rol !== roles.ADMIN) {
                Swal.fire('Acceso Restringido', 'Solo administradores pueden eliminar', 'warning');
                return;
            }

            const producto = productos.find(p => p.id === productoId);
            if (!producto) return;

            Swal.fire({
                title: '¿Eliminar?',
                text: `Se eliminará: ${producto.nombre}`,
                icon: 'warning',
                showCancelButton: true,
                confirmButtonText: 'Eliminar',
                cancelButtonText: 'Cancelar'
            }).then((result) => {
                if (result.isConfirmed) {
                    const index = productos.findIndex(p => p.id === productoId);
                    productos.splice(index, 1);
                    
                    cargarProductosTabla();
                    cargarProductos();
                    actualizarMetricas();
                    
                    agregarActividad(
                        'Producto eliminado',
                        `${producto.nombre}`,
                        'fas fa-trash',
                        'text-danger'
                    );
                    
                    Swal.fire('Eliminado', 'Producto eliminado', 'success');
                }
            });
        }

        function agregarCliente() {
            if (currentUser.rol === roles.PROVEEDOR) {
                Swal.fire('Acceso Restringido', 'Los proveedores no pueden agregar clientes', 'warning');
                return;
            }

            Swal.fire({
                title: 'Nuevo Cliente',
                html: `
                    <div class="form-group text-left">
                        <label>Nombre:</label>
                        <input type="text" class="form-control" id="clienteNuevoNombre" required>
                    </div>
                    <div class="form-group text-left">
                        <label>Email:</label>
                        <input type="email" class="form-control" id="clienteNuevoEmail" required>
                    </div>
                    <div class="form-group text-left">
                        <label>Teléfono:</label>
                        <input type="tel" class="form-control" id="clienteNuevoTelefono" required>
                    </div>
                    <div class="form-group text-left">
                        <label>Dirección:</label>
                        <input type="text" class="form-control" id="clienteNuevaDireccion">
                    </div>
                `,
                showCancelButton: true,
                confirmButtonText: 'Agregar',
                preConfirm: () => {
                    const nombre = document.getElementById('clienteNuevoNombre').value;
                    const email = document.getElementById('clienteNuevoEmail').value;
                    const telefono = document.getElementById('clienteNuevoTelefono').value;
                    
                    if (!nombre || !email || !telefono) {
                        Swal.showValidationMessage('Complete los campos obligatorios');
                        return false;
                    }
                    
                    return {
                        nombre,
                        email,
                        telefono,
                        direccion: document.getElementById('clienteNuevaDireccion').value
                    };
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    const nuevoCliente = {
                        id: Math.max(...clientes.map(c => c.id)) + 1,
                        ...result.value,
                        totalCompras: 0,
                        equipos: 0
                    };
                    
                    clientes.push(nuevoCliente);
                    actualizarMetricas();
                    
                    agregarActividad(
                        'Cliente agregado',
                        `${nuevoCliente.nombre}`,
                        'fas fa-user-plus',
                        'text-success'
                    );
                    
                    Swal.fire('Éxito', 'Cliente agregado correctamente', 'success');
                }
            });
        }

        function verCliente(clienteId) {
            const cliente = clientes.find(c => c.id === clienteId);
            if (!cliente) return;

            Swal.fire({
                title: `Cliente: ${cliente.nombre}`,
                html: `
                    <div class="text-left">
                        <p><strong>Email:</strong> ${cliente.email}</p>
                        <p><strong>Teléfono:</strong> ${cliente.telefono}</p>
                        <p><strong>Dirección:</strong> ${cliente.direccion}</p>
                        <p><strong>Total Compras:</strong> ${cliente.totalCompras.toLocaleString()}</p>
                        <p><strong>Equipos:</strong> ${cliente.equipos}</p>
                    </div>
                `,
                confirmButtonText: 'Cerrar'
            });
        }

        function editarCliente(clienteId) {
            const cliente = clientes.find(c => c.id === clienteId);
            if (!cliente) return;

            Swal.fire({
                title: 'Editar Cliente',
                html: `
                    <div class="form-group text-left">
                        <label>Nombre:</label>
                        <input type="text" class="form-control" id="editClienteNombre" value="${cliente.nombre}">
                    </div>
                    <div class="form-group text-left">
                        <label>Email:</label>
                        <input type="email" class="form-control" id="editClienteEmail" value="${cliente.email}">
                    </div>
                    <div class="form-group text-left">
                        <label>Teléfono:</label>
                        <input type="tel" class="form-control" id="editClienteTelefono" value="${cliente.telefono}">
                    </div>
                    <div class="form-group text-left">
                        <label>Dirección:</label>
                        <input type="text" class="form-control" id="editClienteDireccion" value="${cliente.direccion}">
                    </div>
                `,
                showCancelButton: true,
                confirmButtonText: 'Guardar',
                preConfirm: () => {
                    return {
                        nombre: document.getElementById('editClienteNombre').value,
                        email: document.getElementById('editClienteEmail').value,
                        telefono: document.getElementById('editClienteTelefono').value,
                        direccion: document.getElementById('editClienteDireccion').value
                    };
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    cliente.nombre = result.value.nombre;
                    cliente.email = result.value.email;
                    cliente.telefono = result.value.telefono;
                    cliente.direccion = result.value.direccion;
                    
                    agregarActividad(
                        'Cliente editado',
                        `${cliente.nombre}`,
                        'fas fa-user-edit',
                        'text-info'
                    );
                    
                    Swal.fire('Actualizado', 'Cliente actualizado correctamente', 'success');
                }
            });
        }

        function cerrarSesion() {
            Swal.fire({
                title: '¿Cerrar sesión?',
                icon: 'question',
                showCancelButton: true,
                confirmButtonText: 'Sí',
                cancelButtonText: 'No'
            }).then((result) => {
                if (result.isConfirmed) {
                    Swal.fire('Sesión cerrada', '¡Hasta luego!', 'success');
                }
            });
        }

        // Funciones adicionales para ventas y productos
        function verDetalleVenta(ventaId) {
            const venta = ventasHistorial.find(v => v.id === ventaId);
            if (!venta) return;

            let detalleHtml = '<div class="text-left">';
            detalleHtml += `<h6>Información de la Venta:</h6>`;
            detalleHtml += `<p><strong>Factura:</strong> ${venta.id}</p>`;
            detalleHtml += `<p><strong>Cliente:</strong> ${venta.cliente}</p>`;
            detalleHtml += `<p><strong>Fecha:</strong> ${venta.fecha.toLocaleDateString()} ${venta.fecha.toLocaleTimeString()}</p>`;
            detalleHtml += `<p><strong>Vendedor:</strong> ${venta.vendedor}</p>`;
            detalleHtml += `<hr><h6>Productos Vendidos:</h6>`;
            
            venta.items.forEach(item => {
                const producto = productos.find(p => p.id === item.id);
                const imagen = producto ? producto.imagen : 'https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=60';
                
                detalleHtml += `
                    <div class="d-flex align-items-center mb-3 p-2" style="background: #f8f9fa; border-radius: 8px;">
                        <img src="${imagen}" alt="${item.nombre}" 
                             style="width: 50px; height: 50px; object-fit: cover; border-radius: 8px; margin-right: 10px;">
                        <div class="flex-grow-1">
                            <strong>${item.nombre}</strong><br>
                            <small>Cantidad: ${item.cantidad} × ${item.precio.toLocaleString()}</small>
                        </div>
                        <div class="text-right">
                            <strong>${(item.precio * item.cantidad).toLocaleString()}</strong>
                        </div>
                    </div>
                `;
            });
            
            detalleHtml += `<hr>`;
            detalleHtml += `<div class="text-right">`;
            detalleHtml += `<p>Subtotal: <strong>${venta.subtotal.toLocaleString()}</strong></p>`;
            detalleHtml += `<p>IVA (19%): <strong>${venta.iva.toLocaleString()}</strong></p>`;
            detalleHtml += `<p class="h5">Total: <strong class="text-success">${venta.total.toLocaleString()}</strong></p>`;
            detalleHtml += `</div></div>`;

            Swal.fire({
                title: `Detalle de Venta ${venta.id}`,
                html: detalleHtml,
                width: '700px',
                confirmButtonText: 'Cerrar',
                showCancelButton: true,
                cancelButtonText: 'Imprimir',
                reverseButtons: true
            }).then((result) => {
                if (!result.isConfirmed) {
                    // Si presionó imprimir (cancelar)
                    imprimirVenta(ventaId);
                }
            });
        }

        function imprimirVenta(ventaId) {
            const venta = ventasHistorial.find(v => v.id === ventaId);
            if (venta) {
                mostrarFactura(venta);
            }
        }

        function verDetalleProducto(productoId) {
            const producto = productos.find(p => p.id === productoId);
            if (!producto) return;

            // Buscar ventas de este producto
            const ventasProducto = ventasHistorial.filter(v => 
                v.items.some(item => item.id === productoId)
            );

            const totalVendido = ventasProducto.reduce((total, venta) => {
                const item = venta.items.find(i => i.id === productoId);
                return total + (item ? item.cantidad : 0);
            }, 0);

            const ingresosTotales = ventasProducto.reduce((total, venta) => {
                const item = venta.items.find(i => i.id === productoId);
                return total + (item ? item.precio * item.cantidad : 0);
            }, 0);

            const estadoStock = producto.stock === 0 ? 'Sin stock' : 
                               producto.stock <= 5 ? 'Stock bajo' : 'Stock disponible';
            
            const estadoColor = producto.stock === 0 ? 'text-danger' : 
                               producto.stock <= 5 ? 'text-warning' : 'text-success';

            Swal.fire({
                title: producto.nombre,
                html: `
                    <div class="text-left">
                        <div class="text-center mb-3">
                            <img src="${producto.imagen}" alt="${producto.nombre}" 
                                 style="width: 120px; height: 120px; object-fit: cover; border-radius: 12px; border: 3px solid #dee2e6;"
                                 onerror="this.src='https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=120'">
                        </div>
                        
                        <h6>Información del Producto:</h6>
                        <p><strong>ID:</strong> #${producto.id}</p>
                        <p><strong>Categoría:</strong> ${producto.categoria}</p>
                        <p><strong>Precio:</strong> <span class="text-success">${producto.precio.toLocaleString()}</span></p>
                        <p><strong>Stock actual:</strong> <span class="${estadoColor}">${producto.stock} unidades (${estadoStock})</span></p>
                        <p><strong>Proveedor:</strong> ${producto.proveedor}</p>
                        <p><strong>Descripción:</strong> ${producto.descripcion}</p>
                        
                        <hr>
                        
                        <h6>Estadísticas de Ventas:</h6>
                        <p><strong>Total vendido:</strong> ${totalVendido} unidades</p>
                        <p><strong>Ingresos generados:</strong> <span class="text-success">${ingresosTotales.toLocaleString()}</span></p>
                        <p><strong>Número de ventas:</strong> ${ventasProducto.length}</p>
                        
                        ${ventasProducto.length > 0 ? `
                            <hr>
                            <h6>Últimas Ventas:</h6>
                            ${ventasProducto.slice(-3).reverse().map(venta => {
                                const item = venta.items.find(i => i.id === productoId);
                                return `
                                    <div class="d-flex justify-content-between mb-1">
                                        <small>${venta.fecha.toLocaleDateString()} - ${venta.cliente}</small>
                                        <small><strong>${item.cantidad} × ${item.precio.toLocaleString()}</strong></small>
                                    </div>
                                `;
                            }).join('')}
                        ` : '<p><small class="text-muted">No hay ventas registradas de este producto</small></p>'}
                    </div>
                `,
                width: '600px',
                confirmButtonText: 'Cerrar',
                showCancelButton: true,
                cancelButtonText: 'Editar Producto'
            }).then((result) => {
                if (!result.isConfirmed) {
                    // Si presionó editar
                    editarProducto(productoId);
                }
            });
        }
        function inicializarDatos() {
            // Agregar venta de ejemplo
            setTimeout(() => {
                if (ventasHistorial.length === 0) {
                    const ventaEjemplo = {
                        id: 'F000001',
                        fecha: new Date(Date.now() - 86400000),
                        cliente: 'María García',
                        items: [
                            { id: 8, nombre: 'Mouse Gaming 12000 DPI', precio: 150000, cantidad: 1 }
                        ],
                        subtotal: 150000,
                        iva: 28500,
                        total: 178500,
                        metodoPago: 'tarjeta',
                        estado: 'completada',
                        vendedor: 'Administrador'
                    };
                    ventasHistorial.push(ventaEjemplo);
                }
                
                // Orden de ejemplo
                if (ordenesServicio.length === 0) {
                    const ordenEjemplo = {
                        id: 'OS000001',
                        fecha: new Date(Date.now() - 172800000),
                        cliente: {
                            nombre: 'Juan Pérez',
                            telefono: '3001234567',
                            email: 'juan@email.com'
                        },
                        equipo: {
                            tipo: 'laptop',
                            marca: 'Dell',
                            modelo: 'Inspiron 15',
                            serie: 'DL123456789',
                            problema: 'No enciende correctamente',
                            estado: 'Equipo con golpes menores'
                        },
                        estado: 'diagnostico',
                        tecnico: 'Juan Martínez'
                    };
                    ordenesServicio.push(ordenEjemplo);
                }
                
                actualizarTablaEquipos();
                actualizarMetricas();
            }, 1000);
        }
    </script>
</body>
</html>